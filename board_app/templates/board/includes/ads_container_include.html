{% load tz %}

<div class="adCard col-lg-4 col-md-6 mb-4 my-3" data-ad-id="{{ advertisement.id }}">
  <div class="card text-dark h-100" style="background-color: #ffdfe7ff">
    <div class="card-body d-flex flex-column">
      {% if advertisement.image %}
      <img
        src="{{ advertisement.image.url }}"
        alt="{{ advertisement.title }}"
        width="300"
        style="
          max-width: 100%;
          max-height: 300px;
          width: auto;
          height: auto;
          object-fit: contain;
        "
      />
      {% endif %}
      <h3 class="card-title mb-3 my-3">
        <a
          href="{% url 'ad_detail' advertisement.id %}"
          style="color: #000000ff"
          >{{ advertisement.title }}</a
        >
      </h3>

      <!-- Избранное -->
      <div style="display: inline-flex; align-items: center; gap: 5px;">
        <button 
            class='favoriteBtn btn btn-link {% if request.user == advertisement.user %}disabled{% endif %}' 
            data-url='{% url "toggle_favorite" %}'
            data-ad-id='{{ advertisement.id }}'>
          {% if request.user in advertisement.favorites.all %}
            <i class='favoriteIcon bi bi-bookmark-fill'></i>
          {% else %}
            <i class='favoriteIcon bi bi-bookmark'></i>
          {% endif %}
        </button>
          <span class='favoriteCount'>{{ advertisement.favorites.count }}</span>
      </div>
      <!--Дата и время-->
      <div class="mt-auto pt-2">
        <small class="text-muted"
          >Создано: {{ advertisement.created_at|localtime|date:'d.m.y' }}</small
        ><br>
        <small class="text-muted"
          >Последнее обновление: {{ advertisement.updated_at|date:'d.m.y' }}</small
        >
      </div>
    </div>
  </div>
</div>