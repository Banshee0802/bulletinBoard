{% load tz %}

<div class="col-lg-4 col-md-6 mb-4 my-3">
  <div class="card text-dark h-100" style="background-color: #ffdfe7ff">
    <div class="card-body d-flex flex-column">
      {% if advertisement.image %}
      <img
        src="{{ advertisement.image.url }}"
        alt="{{ advertisement.title }}"
        width="300"
        style="
          max-width: 100%;
          max-height: 300px;
          width: auto;
          height: auto;
          object-fit: contain;
        "
      />
      {% endif %}
      <h3 class="card-title mb-3 my-3">
        <a
          href="{% url 'ad_detail' advertisement.id %}"
          style="color: #000000ff"
          >{{ advertisement.title }}</a
        >
      </h3>
      
      {% if user.is_authenticated %}
      <div class="mb-3">
        <button class="favorite-btn" data-ad-id="{{ advertisement.id }}">
          <span class="heart {% if advertisement.id in user_favorites %}active{% endif %}">❤</span>
          <span class="favorite-text">
            {% if advertisement.id in user_favorites %}В избранном{% else %}В избранное{% endif %}
          </span>
        </button>
      </div>
      {% endif %}
      
      <div class="mt-auto pt-2">
        <small class="text-muted"
          >Создано: {{ advertisement.created_at|localtime|date:'d.m.y' }}</small
        ><br>
        <small class="text-muted"
          >Последнее обновление: {{ advertisement.updated_at|date:'d.m.y' }}</small
        >
      </div>
    </div>
  </div>
</div>